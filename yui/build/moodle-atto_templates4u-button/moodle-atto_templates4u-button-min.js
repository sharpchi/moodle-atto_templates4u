YUI.add("moodle-atto_templates4u-button",function(n,t){var i="atto_templates4u",e={TEMPLATENAME:"atto_templates4u_name",PREVIEW:"atto_templates4u_preview",INSERT:"atto_templates4u_insert",CANCEL:"atto_templates4u_cancel"},a={TEMPLATES:"."+e.TEMPLATENAME,INSERT:"."+e.INSERT,PREVIEW:"."+e.PREVIEW,CANCEL:"."+e.CANCEL},o='<form class="atto_form"><div class="form-group"><label for="{{elementid}}_{{CSS.TEMPLATENAME}}">{{{get_string "selectatemplate" component}}}</label><select class="{{CSS.TEMPLATENAME}} form-control" id="{{elementid}}_{{CSS.TEMPLATENAME}}" name="{{elementid}}_{{CSS.TEMPLATENAME}}"><option value="">{{get_string "selectatemplate" component}}</option>{{#each templates}}<option value="{{templatekey}}">{{templatekey}}</option>{{/each}}</select></div><label for="{{elementid}}_{{CSS.PREVIEW}}">{{get_string "preview" component}}</label><div class="card"><div class="card-block {{CSS.PREVIEW}}" id="{{elementid}}_{{CSS.PREVIEW}}"></div></div><div class="mdl-align"><button class="btn btn-primary {{CSS.INSERT}}">{{get_string "insert" component}}</button> <button class="btn btn-secondary {{CSS.CANCEL}}">{{get_string "cancel" component}}</button></div></form>';n.namespace("M.atto_templates4u").Button=n.Base.create("button",n.M.editor_atto.EditorPlugin,[],{_content:null,_templates:[],initializer:function(){this.get("enablebutton")&&(this.addButton({icon:"icon",iconComponent:i,callback:this._displayDialogue}),this._templates=this.get("templates"))},_displayDialogue:function(){var t=this.getDialogue({headerContent:M.util.get_string("pluginname",i),focusAfterHide:!0,width:600}),e=this._getDialogueContent();t.set("bodyContent",e),t.show()},_getDialogueContent:function(){var t=n.Handlebars.compile(o);return this._templates=this.get("templates"),this._content=n.Node.create(t({elementid:this.get("host").get("elementid"),component:i,templates:this._templates,CSS:e})),this._content.one(a.TEMPLATES).on("change",this._previewTemplate,this),this._content.one(a.INSERT).on("click",this._insertTemplate,this),this._content.one(a.CANCEL).on("click",this._cancel,this),this._content},_previewTemplate:function(t){var t=t.currentTarget,t=t.get("value"),t=this._templateFilter(t),e=n.one(a.PREVIEW);e.setHTML(t.template)},_insertTemplate:function(t){var e=this.get("host");t.preventDefault(),this.getDialogue({focusAfterHide:null}).hide(),t=n.one(a.TEMPLATES).get("value"),t=this._templateFilter(t),e.insertContentAtFocusPoint(t.template),this.markUpdated()},_cancel:function(t){t.preventDefault(),this.getDialogue().hide()},_templateFilter:function(t){for(var e=0;e<this._templates.length;e++)if(this._templates[e].templatekey==t)return this._templates[e];return[]}},{ATTRS:{templates:{value:{}},enablebutton:{value:!1}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});